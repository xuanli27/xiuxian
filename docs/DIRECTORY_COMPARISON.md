# ç›®å½•ç»“æ„å¯¹æ¯”ä¸ä¼˜åŒ–è¯´æ˜

> ä» Vite + React åˆ° Next.js 15 App Router  
> æ¶æ„æ¼”è¿›: Monolithic â†’ Modular + Feature-Based

## ğŸ“Š å®Œæ•´ç›®å½•å¯¹æ¯”

### ğŸ”´ å½“å‰ç»“æ„ (Vite + React)

```
xiuxian/                              # é¡¹ç›®æ ¹ç›®å½•
â”‚
â”œâ”€â”€ components/                       # âš ï¸ æ‰€æœ‰ç»„ä»¶æ··åœ¨ä¸€èµ·
â”‚   â”œâ”€â”€ cave/                        # æ´åºœç›¸å…³
â”‚   â”‚   â”œâ”€â”€ CaveAbode.tsx
â”‚   â”‚   â”œâ”€â”€ CaveManager.tsx
â”‚   â”‚   â””â”€â”€ CraftingStation.tsx
â”‚   â”œâ”€â”€ dashboard/                   # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â””â”€â”€ SpiritCoreVisualizer.tsx
â”‚   â”œâ”€â”€ inventory/                   # èƒŒåŒ…
â”‚   â”‚   â”œâ”€â”€ EquipmentPanel.tsx
â”‚   â”‚   â””â”€â”€ Inventory.tsx
â”‚   â”œâ”€â”€ layout/                      # å¸ƒå±€
â”‚   â”‚   â””â”€â”€ Layout.tsx
â”‚   â”œâ”€â”€ onboarding/                  # æ–°æ‰‹å¼•å¯¼
â”‚   â”‚   â”œâ”€â”€ IntroStory.tsx
â”‚   â”‚   â”œâ”€â”€ MindPathQuiz.tsx
â”‚   â”‚   â””â”€â”€ SpiritRootCanvas.tsx
â”‚   â”œâ”€â”€ sect/                        # é—¨æ´¾
â”‚   â”‚   â”œâ”€â”€ IdentityCard.tsx
â”‚   â”‚   â””â”€â”€ SectHall.tsx
â”‚   â”œâ”€â”€ tasks/                       # ä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ NavigationStation.tsx
â”‚   â”‚   â”œâ”€â”€ TaskBoard.tsx
â”‚   â”‚   â”œâ”€â”€ TaskCard.tsx
â”‚   â”‚   â””â”€â”€ minigames/              # å°æ¸¸æˆ
â”‚   â”‚       â”œâ”€â”€ BattleArena.tsx
â”‚   â”‚       â”œâ”€â”€ LogicPuzzleGame.tsx
â”‚   â”‚       â”œâ”€â”€ MessageCleanerGame.tsx
â”‚   â”‚       â””â”€â”€ StockMarketGame.tsx
â”‚   â”œâ”€â”€ tribulation/                 # æ¸¡åŠ«
â”‚   â”‚   â””â”€â”€ Tribulation.tsx
â”‚   â””â”€â”€ ui/                          # UIç»„ä»¶
â”‚       â”œâ”€â”€ Badge.tsx
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â”œâ”€â”€ Card.tsx
â”‚       â”œâ”€â”€ Modal.tsx
â”‚       â”œâ”€â”€ PageHeader.tsx
â”‚       â”œâ”€â”€ Shared.tsx
â”‚       â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ app/                             # âœ… å·²è¿ç§»
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ lib/                             # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ auth.ts                 # âœ… NextAuthé…ç½®
â”‚   â””â”€â”€ db/
â”‚       â”œâ”€â”€ prisma.ts               # âœ… Prismaå®¢æˆ·ç«¯
â”‚       â””â”€â”€ schema.ts               # âš ï¸ æ—§Drizzle Schema (å¾…åˆ é™¤)
â”‚
â”œâ”€â”€ services/                        # âš ï¸ æœåŠ¡å±‚æ··ä¹±
â”‚   â””â”€â”€ geminiService.ts            # AIæœåŠ¡
â”‚
â”œâ”€â”€ store/                           # âš ï¸ çŠ¶æ€ç®¡ç†å•ä¸€æ–‡ä»¶
â”‚   â””â”€â”€ useGameStore.ts             # Zustand store
â”‚
â”œâ”€â”€ data/                            # âš ï¸ æ•°æ®å’Œå¸¸é‡æ··åœ¨ä¸€èµ·
â”‚   â””â”€â”€ constants.ts                # æ¸¸æˆå¸¸é‡
â”‚
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma               # âœ… Prisma Schema
â”‚
â”œâ”€â”€ public/                          # é™æ€èµ„æº
â”œâ”€â”€ styles/                          # æ ·å¼
â”‚
â”œâ”€â”€ App.tsx                          # âš ï¸ Viteå…¥å£ (å¾…åˆ é™¤)
â”œâ”€â”€ index.tsx                        # âš ï¸ Reactå…¥å£ (å¾…åˆ é™¤)
â”œâ”€â”€ index.html                       # âš ï¸ Vite HTML (å¾…åˆ é™¤)
â”œâ”€â”€ vite.config.ts                   # âš ï¸ Viteé…ç½® (å¾…åˆ é™¤)
â”œâ”€â”€ drizzle.config.ts               # âš ï¸ Drizzleé…ç½® (å¾…åˆ é™¤)
â”‚
â”œâ”€â”€ next.config.ts                   # âœ… Next.jsé…ç½®
â”œâ”€â”€ tailwind.config.ts               # âœ… Tailwindé…ç½®
â”œâ”€â”€ tsconfig.json                    # âœ… TypeScripté…ç½®
â”œâ”€â”€ middleware.ts                    # âœ… è·¯ç”±ä¿æŠ¤
â”œâ”€â”€ package.json                     # âœ… ä¾èµ–ç®¡ç†
â””â”€â”€ README.md
```

**å½“å‰é—®é¢˜**:
- âŒ æ‰€æœ‰ç»„ä»¶å¹³é“ºåœ¨ `components/`,ç¼ºä¹å±‚æ¬¡
- âŒ æ²¡æœ‰æ˜ç¡®çš„ä¸šåŠ¡é€»è¾‘å±‚
- âŒ æœåŠ¡å±‚ã€æ•°æ®å±‚æ··ä¹±
- âŒ çŠ¶æ€ç®¡ç†åˆ†æ•£
- âŒ ç¼ºå°‘ç±»å‹å®šä¹‰å’ŒéªŒè¯
- âŒ ä¸æ”¯æŒ Server Components
- âŒ è·¯ç”±é€»è¾‘ä¸æ¸…æ™°

---

### ğŸŸ¢ ä¼˜åŒ–åç»“æ„ (Next.js 15)

```
xiuxian/                              # é¡¹ç›®æ ¹ç›®å½•
â”‚
â”œâ”€â”€ app/                              # ğŸ“ Next.js App Router (è·¯ç”±+é¡µé¢)
â”‚   â”œâ”€â”€ (auth)/                      # ğŸ” è®¤è¯è·¯ç”±ç»„ (æ— å…±äº«å¸ƒå±€)
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx            # ç™»å½•é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ _components/        # é¡µé¢ç§æœ‰ç»„ä»¶
â”‚   â”‚   â”‚       â””â”€â”€ AuthForm.tsx
â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚       â””â”€â”€ page.tsx            # æ³¨å†Œé¡µé¢ (å¯é€‰)
â”‚   â”‚
â”‚   â”œâ”€â”€ (game)/                      # ğŸ® æ¸¸æˆä¸»è·¯ç”±ç»„ (å…±äº«å¸ƒå±€)
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # æ¸¸æˆä¸»å¸ƒå±€ (å¯¼èˆª+ä¾§è¾¹æ )
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ dashboard/              # ğŸ“Š ä»ªè¡¨ç›˜
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â”œâ”€â”€ StatsCard.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ RealmProgress.tsx
â”‚   â”‚   â”‚       â””â”€â”€ SpiritCore.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ tasks/                  # ğŸ“ ä»»åŠ¡å¤§å…
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/              # åŠ¨æ€è·¯ç”±
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â”œâ”€â”€ TaskCard.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ TaskFilters.tsx
â”‚   â”‚   â”‚       â””â”€â”€ minigames/     # å°æ¸¸æˆç»„ä»¶
â”‚   â”‚   â”‚           â”œâ”€â”€ BattleArena.tsx
â”‚   â”‚   â”‚           â”œâ”€â”€ LogicPuzzle.tsx
â”‚   â”‚   â”‚           â””â”€â”€ StockMarket.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cultivation/            # ğŸ§˜ ä¿®ç‚¼åœº (æ–°å¢)
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ meditation/        # æ‰“å
â”‚   â”‚   â”‚   â”œâ”€â”€ techniques/        # åŠŸæ³•
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cave/                   # ğŸ  æ´åºœ
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ crafting/          # ç‚¼å™¨ç‚¼ä¸¹
â”‚   â”‚   â”‚   â”œâ”€â”€ garden/            # çµç”°
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â”œâ”€â”€ CaveAbode.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ CaveManager.tsx
â”‚   â”‚   â”‚       â””â”€â”€ CraftingStation.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ inventory/              # ğŸ’ èƒŒåŒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ equipment/         # è£…å¤‡
â”‚   â”‚   â”‚   â”œâ”€â”€ pills/             # ä¸¹è¯
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â”œâ”€â”€ EquipmentPanel.tsx
â”‚   â”‚   â”‚       â””â”€â”€ Inventory.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sect/                   # ğŸ›ï¸ é—¨æ´¾
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ hall/              # å¤§æ®¿
â”‚   â”‚   â”‚   â”œâ”€â”€ library/           # è—ç»é˜
â”‚   â”‚   â”‚   â”œâ”€â”€ market/            # åŠå¸‚
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â”œâ”€â”€ IdentityCard.tsx
â”‚   â”‚   â”‚       â””â”€â”€ SectHall.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ tribulation/            # âš¡ æ¸¡åŠ«
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ _components/
â”‚   â”‚   â”‚       â””â”€â”€ Tribulation.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ leaderboard/            # ğŸ† æ’è¡Œæ¦œ (æ–°å¢)
â”‚   â”‚       â”œâ”€â”€ page.tsx
â”‚   â”‚       â””â”€â”€ _components/
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                         # ğŸ”Œ APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ [...nextauth]/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts        # NextAuthç«¯ç‚¹
â”‚   â”‚   â””â”€â”€ webhooks/               # Webhooks
â”‚   â”‚       â””â”€â”€ stripe/
â”‚   â”‚           â””â”€â”€ route.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                   # å…¨å±€æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx                     # é¦–é¡µ (é‡å®šå‘)
â”‚   â”œâ”€â”€ globals.css                  # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ error.tsx                    # å…¨å±€é”™è¯¯é¡µ
â”‚
â”œâ”€â”€ features/                         # ğŸ¯ ä¸šåŠ¡åŠŸèƒ½æ¨¡å— (æ ¸å¿ƒåˆ›æ–°)
â”‚   â”œâ”€â”€ player/                      # ç©å®¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts              # Server Actions (CRUD)
â”‚   â”‚   â”œâ”€â”€ queries.ts              # æ•°æ®æŸ¥è¯¢å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ schemas.ts              # Zod éªŒè¯æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ types.ts                # TypeScript ç±»å‹
â”‚   â”‚   â””â”€â”€ utils.ts                # æ¨¡å—å·¥å…·å‡½æ•°
â”‚   â”‚
â”‚   â”œâ”€â”€ tasks/                       # ä»»åŠ¡ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts              # åˆ›å»º/æ›´æ–°/å®Œæˆä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ queries.ts              # ä»»åŠ¡æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ schemas.ts              # ä»»åŠ¡éªŒè¯
â”‚   â”‚   â”œâ”€â”€ types.ts                # ä»»åŠ¡ç±»å‹
â”‚   â”‚   â””â”€â”€ ai-generator.ts         # AIä»»åŠ¡ç”Ÿæˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ cultivation/                 # ä¿®ç‚¼ç³»ç»Ÿ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ actions.ts
â”‚   â”‚   â”œâ”€â”€ realm-calculator.ts     # å¢ƒç•Œè®¡ç®—
â”‚   â”‚   â”œâ”€â”€ experience.ts           # ç»éªŒç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ inventory/                   # èƒŒåŒ…ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts
â”‚   â”‚   â”œâ”€â”€ equipment.ts            # è£…å¤‡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ items.ts                # ç‰©å“ç®¡ç†
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ cave/                        # æ´åºœç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts
â”‚   â”‚   â”œâ”€â”€ crafting.ts             # ç‚¼åˆ¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ garden.ts               # ç§æ¤ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ sect/                        # é—¨æ´¾ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts
â”‚   â”‚   â”œâ”€â”€ ranks.ts                # ç­‰çº§ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ missions.ts             # é—¨æ´¾ä»»åŠ¡
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ tribulation/                 # æ¸¡åŠ«ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ actions.ts
â”‚   â”‚   â”œâ”€â”€ challenges.ts           # åŠ«éš¾æŒ‘æˆ˜
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”‚
â”‚   â””â”€â”€ leaderboard/                 # æ’è¡Œæ¦œç³»ç»Ÿ
â”‚       â”œâ”€â”€ actions.ts
â”‚       â”œâ”€â”€ queries.ts
â”‚       â””â”€â”€ types.ts
â”‚
â”œâ”€â”€ components/                       # ğŸ§© å…±äº«UIç»„ä»¶
â”‚   â”œâ”€â”€ ui/                          # åŸºç¡€UIç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ button.tsx              # æŒ‰é’®
â”‚   â”‚   â”œâ”€â”€ card.tsx                # å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ modal.tsx               # æ¨¡æ€æ¡†
â”‚   â”‚   â”œâ”€â”€ badge.tsx               # å¾½ç« 
â”‚   â”‚   â”œâ”€â”€ progress.tsx            # è¿›åº¦æ¡
â”‚   â”‚   â”œâ”€â”€ tabs.tsx                # æ ‡ç­¾é¡µ
â”‚   â”‚   â””â”€â”€ index.ts                # ç»Ÿä¸€å¯¼å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ game/                        # æ¸¸æˆä¸“ç”¨ç»„ä»¶ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ RealmBadge.tsx          # å¢ƒç•Œå¾½ç« 
â”‚   â”‚   â”œâ”€â”€ ExperienceBar.tsx       # ç»éªŒæ¡
â”‚   â”‚   â”œâ”€â”€ CurrencyDisplay.tsx     # è´§å¸æ˜¾ç¤º
â”‚   â”‚   â”œâ”€â”€ SpiritRootIcon.tsx      # çµæ ¹å›¾æ ‡
â”‚   â”‚   â””â”€â”€ StatDisplay.tsx         # å±æ€§æ˜¾ç¤º
â”‚   â”‚
â”‚   â”œâ”€â”€ layout/                      # å¸ƒå±€ç»„ä»¶ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ Header.tsx              # é¡¶éƒ¨å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx             # ä¾§è¾¹æ 
â”‚   â”‚   â”œâ”€â”€ Footer.tsx              # é¡µè„š
â”‚   â”‚   â””â”€â”€ MobileNav.tsx           # ç§»åŠ¨å¯¼èˆª
â”‚   â”‚
â”‚   â””â”€â”€ providers/                   # ä¸Šä¸‹æ–‡æä¾›è€… (æ–°å¢)
â”‚       â”œâ”€â”€ QueryProvider.tsx       # TanStack Query
â”‚       â”œâ”€â”€ ThemeProvider.tsx       # ä¸»é¢˜åˆ‡æ¢
â”‚       â””â”€â”€ AuthProvider.tsx        # è®¤è¯çŠ¶æ€
â”‚
â”œâ”€â”€ lib/                             # ğŸ› ï¸ æ ¸å¿ƒå·¥å…·åº“
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ auth.ts                 # NextAuth é…ç½®
â”‚   â”‚   â”œâ”€â”€ guards.ts               # æƒé™å®ˆå« (æ–°å¢)
â”‚   â”‚   â””â”€â”€ utils.ts                # è®¤è¯å·¥å…· (æ–°å¢)
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ prisma.ts               # Prisma å•ä¾‹
â”‚   â”‚   â”œâ”€â”€ seed.ts                 # æ•°æ®ç§å­ (æ–°å¢)
â”‚   â”‚   â””â”€â”€ migrations/             # è‡ªå®šä¹‰è¿ç§» (æ–°å¢)
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                          # AIé›†æˆ (é‡æ„)
â”‚   â”‚   â”œâ”€â”€ client.ts               # AI SDK å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ prompts.ts              # æç¤ºè¯æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ generators/             # ç”Ÿæˆå™¨é›†åˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ task-generator.ts  # ä»»åŠ¡ç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ story-generator.ts # å‰§æƒ…ç”Ÿæˆ
â”‚   â”‚   â”‚   â””â”€â”€ name-generator.ts  # åç§°ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ types.ts                # AIç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ game/                        # æ¸¸æˆæ ¸å¿ƒé€»è¾‘ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ constants.ts            # æ¸¸æˆå¸¸é‡
â”‚   â”‚   â”œâ”€â”€ formulas.ts             # è®¡ç®—å…¬å¼
â”‚   â”‚   â”œâ”€â”€ random.ts               # éšæœºç®—æ³•
â”‚   â”‚   â””â”€â”€ validators.ts           # ä¸šåŠ¡éªŒè¯
â”‚   â”‚
â”‚   â””â”€â”€ utils/                       # é€šç”¨å·¥å…· (æ–°å¢)
â”‚       â”œâ”€â”€ cn.ts                   # className åˆå¹¶
â”‚       â”œâ”€â”€ date.ts                 # æ—¥æœŸå¤„ç†
â”‚       â”œâ”€â”€ format.ts               # æ ¼å¼åŒ–å·¥å…·
â”‚       â””â”€â”€ storage.ts              # æœ¬åœ°å­˜å‚¨
â”‚
â”œâ”€â”€ hooks/                           # ğŸ£ è‡ªå®šä¹‰Hooks (æ–°å¢)
â”‚   â”œâ”€â”€ use-player.ts               # ç©å®¶æ•°æ®Hook
â”‚   â”œâ”€â”€ use-tasks.ts                # ä»»åŠ¡æ•°æ®Hook
â”‚   â”œâ”€â”€ use-inventory.ts            # èƒŒåŒ…Hook
â”‚   â”œâ”€â”€ use-debounce.ts             # é˜²æŠ–Hook
â”‚   â”œâ”€â”€ use-local-storage.ts        # æœ¬åœ°å­˜å‚¨Hook
â”‚   â””â”€â”€ use-media-query.ts          # å“åº”å¼Hook
â”‚
â”œâ”€â”€ stores/                          # ğŸ“¦ çŠ¶æ€ç®¡ç† (é‡æ„)
â”‚   â”œâ”€â”€ game-store.ts               # æ¸¸æˆå…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ ui-store.ts                 # UIçŠ¶æ€ (ä¾§è¾¹æ /æ¨¡æ€æ¡†)
â”‚   â””â”€â”€ cache-store.ts              # å®¢æˆ·ç«¯ç¼“å­˜
â”‚
â”œâ”€â”€ styles/                          # ğŸ¨ æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ globals.css                 # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ themes/                     # ä¸»é¢˜å˜é‡ (æ–°å¢)
â”‚   â”‚   â”œâ”€â”€ light.css
â”‚   â”‚   â””â”€â”€ dark.css
â”‚   â””â”€â”€ animations.css              # åŠ¨ç”»æ•ˆæœ (æ–°å¢)
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma               # æ•°æ®åº“Schema
â”‚   â”œâ”€â”€ migrations/                 # è¿ç§»å†å²
â”‚   â””â”€â”€ seeds/                      # ç§å­æ•°æ® (æ–°å¢)
â”‚       â”œâ”€â”€ realms.ts               # å¢ƒç•Œæ•°æ®
â”‚       â”œâ”€â”€ items.ts                # ç‰©å“æ•°æ®
â”‚       â””â”€â”€ techniques.ts           # åŠŸæ³•æ•°æ®
â”‚
â”œâ”€â”€ public/                          # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ realms/                 # å¢ƒç•Œå›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ items/                  # ç‰©å“å›¾æ ‡
â”‚   â”‚   â””â”€â”€ backgrounds/            # èƒŒæ™¯å›¾
â”‚   â”œâ”€â”€ sounds/                     # éŸ³æ•ˆ (æ–°å¢)
â”‚   â””â”€â”€ fonts/                      # å­—ä½“ (æ–°å¢)
â”‚
â”œâ”€â”€ config/                          # âš™ï¸ é…ç½®æ–‡ä»¶ (æ–°å¢)
â”‚   â”œâ”€â”€ site.ts                     # ç«™ç‚¹é…ç½®
â”‚   â”œâ”€â”€ game.ts                     # æ¸¸æˆé…ç½®
â”‚   â”œâ”€â”€ navigation.ts               # å¯¼èˆªé…ç½®
â”‚   â””â”€â”€ features.ts                 # åŠŸèƒ½å¼€å…³
â”‚
â”œâ”€â”€ types/                           # ğŸ“˜ å…¨å±€ç±»å‹å®šä¹‰ (æ–°å¢)
â”‚   â”œâ”€â”€ game.ts                     # æ¸¸æˆç±»å‹
â”‚   â”œâ”€â”€ api.ts                      # APIç±»å‹
â”‚   â””â”€â”€ env.d.ts                    # ç¯å¢ƒå˜é‡ç±»å‹
â”‚
â”œâ”€â”€ docs/                            # ğŸ“š é¡¹ç›®æ–‡æ¡£ (æ–°å¢)
â”‚   â”œâ”€â”€ PROJECT_OVERVIEW.md         # é¡¹ç›®æ¦‚è§ˆ
â”‚   â”œâ”€â”€ ARCHITECTURE_DESIGN.md      # æ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ MIGRATION_PLAN.md           # è¿ç§»è®¡åˆ’
â”‚   â”œâ”€â”€ DIRECTORY_COMPARISON.md     # ç›®å½•å¯¹æ¯” (æœ¬æ–‡æ¡£)
â”‚   â”œâ”€â”€ API_REFERENCE.md            # APIå‚è€ƒ
â”‚   â”œâ”€â”€ GAME_DESIGN.md              # æ¸¸æˆè®¾è®¡
â”‚   â””â”€â”€ DEPLOYMENT.md               # éƒ¨ç½²æŒ‡å—
â”‚
â”œâ”€â”€ tests/                           # ğŸ§ª æµ‹è¯•æ–‡ä»¶ (æ–°å¢)
â”‚   â”œâ”€â”€ unit/                       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/                # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/                        # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚
â”œâ”€â”€ scripts/                         # ğŸ“œ è„šæœ¬å·¥å…· (æ–°å¢)
â”‚   â”œâ”€â”€ setup-db.ts                 # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ generate-types.ts           # ç±»å‹ç”Ÿæˆ
â”‚   â””â”€â”€ backup.ts                   # å¤‡ä»½å·¥å…·
â”‚
â”œâ”€â”€ middleware.ts                    # Next.jsä¸­é—´ä»¶
â”œâ”€â”€ next.config.ts                   # Next.jsé…ç½®
â”œâ”€â”€ tailwind.config.ts               # Tailwindé…ç½®
â”œâ”€â”€ tsconfig.json                    # TypeScripté…ç½®
â”œâ”€â”€ .env.example                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

**ä¼˜åŒ–äº®ç‚¹**:
- âœ… æ¸…æ™°çš„åŠŸèƒ½æ¨¡å—åˆ’åˆ† (`features/`)
- âœ… è·¯ç”±å³é¡µé¢ (`app/`)
- âœ… ç»„ä»¶åˆ†å±‚æ˜ç¡® (ui/game/layout)
- âœ… ä¸šåŠ¡é€»è¾‘é›†ä¸­ç®¡ç†
- âœ… ç±»å‹å®‰å…¨å®Œæ•´è¦†ç›–
- âœ… æ”¯æŒ Server Components
- âœ… çŠ¶æ€ç®¡ç†æ¸…æ™°
- âœ… é…ç½®æ–‡ä»¶ç‹¬ç«‹

---

## ğŸ”„ è¿ç§»æ˜ å°„è¡¨

| æ—§ä½ç½® | æ–°ä½ç½® | è¯´æ˜ |
|--------|--------|------|
| `components/cave/*` | `app/(game)/cave/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/dashboard/*` | `app/(game)/dashboard/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/inventory/*` | `app/(game)/inventory/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/tasks/*` | `app/(game)/tasks/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/sect/*` | `app/(game)/sect/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/tribulation/*` | `app/(game)/tribulation/_components/*` | é¡µé¢ç§æœ‰ç»„ä»¶ |
| `components/onboarding/*` | `app/(game)/dashboard/_components/*` | é¦–æ¬¡ç™»å½•å¼•å¯¼ |
| `components/layout/*` | `components/layout/*` | å…±äº«å¸ƒå±€ç»„ä»¶ |
| `components/ui/*` | `components/ui/*` | ä¿æŒä¸å˜ |
| `services/geminiService.ts` | `lib/ai/client.ts` | AIæœåŠ¡é‡æ„ |
| `store/useGameStore.ts` | `stores/game-store.ts` | é‡å‘½å |
| `data/constants.ts` | `config/game.ts` + `lib/game/*` | æ‹†åˆ†é…ç½®å’Œé€»è¾‘ |
| `lib/db/schema.ts` | âŒ åˆ é™¤ | ä½¿ç”¨Prisma |
| `drizzle.config.ts` | âŒ åˆ é™¤ | ä½¿ç”¨Prisma |
| `App.tsx` | âŒ åˆ é™¤ | ä½¿ç”¨App Router |
| `index.tsx` | âŒ åˆ é™¤ | ä½¿ç”¨App Router |
| `index.html` | âŒ åˆ é™¤ | Next.jsè‡ªåŠ¨ç”Ÿæˆ |
| `vite.config.ts` | âŒ åˆ é™¤ | ä½¿ç”¨next.config.ts |

---

## ğŸ“ˆ æ¶æ„æ”¹è¿›å¯¹æ¯”

### ä»£ç ç»„ç»‡

**æ—§æ¶æ„ (Vite)**:
```
æ‰€æœ‰ä¸šåŠ¡é€»è¾‘æ··åœ¨ç»„ä»¶ä¸­
â†“
éš¾ä»¥æµ‹è¯•ã€éš¾ä»¥å¤ç”¨
```

**æ–°æ¶æ„ (Next.js)**:
```
UIå±‚ (components/) â†’ è¡¨ç°
  â†“
ä¸šåŠ¡å±‚ (features/) â†’ é€»è¾‘  
  â†“
æ•°æ®å±‚ (lib/db/) â†’ æŒä¹…åŒ–
```

### æ•°æ®æµ

**æ—§æ¶æ„**:
```
Component â†’ Zustand Store â†’ API Call â†’ Update Store â†’ Re-render
```

**æ–°æ¶æ„**:
```
Server Component â†’ Direct DB Query â†’ Render
Client Component â†’ TanStack Query â†’ Server Action â†’ DB Update â†’ Auto Revalidate
```

### ç±»å‹å®‰å…¨

**æ—§æ¶æ„**:
```typescript
// ç¼ºå°‘è¿è¡Œæ—¶éªŒè¯
function createTask(data: any) {
  // ç›´æ¥ä½¿ç”¨,å®¹æ˜“å‡ºé”™
}
```

**æ–°æ¶æ„**:
```typescript
// ZodéªŒè¯ + TypeScriptç±»å‹
const schema = z.object({ title: z.string() })
type Input = z.infer<typeof schema>

function createTask(data: unknown) {
  const validated = schema.parse(data) // è‡ªåŠ¨éªŒè¯
  // validated ç±»å‹å®‰å…¨
}
```

---

## ğŸ¯ ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡?

### 1. Features æ¨¡å—åŒ–

**é—®é¢˜**: æ—§æ¶æ„ä¸­,ä¸šåŠ¡é€»è¾‘åˆ†æ•£åœ¨ç»„ä»¶ã€æœåŠ¡ã€storeä¸­

**è§£å†³**: æŒ‰ä¸šåŠ¡é¢†åŸŸç»„ç»‡ä»£ç 
```
features/tasks/
â”œâ”€â”€ actions.ts    # æœåŠ¡ç«¯æ“ä½œ
â”œâ”€â”€ queries.ts    # æ•°æ®æŸ¥è¯¢
â”œâ”€â”€ schemas.ts    # éªŒè¯è§„åˆ™
â”œâ”€â”€ types.ts      # ç±»å‹å®šä¹‰
â””â”€â”€ utils.ts      # å·¥å…·å‡½æ•°
```

**ä¼˜åŠ¿**:
- âœ… é«˜å†…èš: ç›¸å…³ä»£ç åœ¨ä¸€èµ·
- âœ… ä½è€¦åˆ: æ¨¡å—é—´ç‹¬ç«‹
- âœ… æ˜“æµ‹è¯•: å•å…ƒæµ‹è¯•ç®€å•
- âœ… æ˜“æ‰©å±•: æ–°å¢åŠŸèƒ½åªéœ€åŠ æ¨¡å—

### 2. App Router é¡µé¢ç»„ç»‡

**é—®é¢˜**: æ—§æ¶æ„ä¸­,è·¯ç”±å’Œç»„ä»¶åˆ†ç¦»,éš¾ä»¥å…³è”

**è§£å†³**: æ–‡ä»¶å³è·¯ç”±
```
app/(game)/tasks/page.tsx         â†’ /tasks
app/(game)/tasks/[id]/page.tsx    â†’ /tasks/123
```

**ä¼˜åŠ¿**:
- âœ… ç›´è§‚: ç›®å½•ç»“æ„å³è·¯ç”±
- âœ… Server Components: æ€§èƒ½ä¼˜åŒ–
- âœ… å¸ƒå±€å…±äº«: `(game)/layout.tsx`
- âœ… ç§æœ‰ç»„ä»¶: `_components/`ä¸å‚ä¸è·¯ç”±

### 3. ç»„ä»¶åˆ†å±‚

**é—®é¢˜**: æ—§æ¶æ„ä¸­,UIç»„ä»¶å’Œä¸šåŠ¡ç»„ä»¶æ··åœ¨ä¸€èµ·

**è§£å†³**: ä¸‰å±‚ç»„ä»¶
```
components/ui/       â†’ çº¯UI (Button, Card)
components/game/     â†’ æ¸¸æˆä¸šåŠ¡ (RealmBadge)
components/layout/   â†’ å¸ƒå±€ (Header, Sidebar)
```

**ä¼˜åŠ¿**:
- âœ… èŒè´£å•ä¸€
- âœ… å¤ç”¨æ€§é«˜
- âœ… æµ‹è¯•ç®€å•

### 4. æ ¸å¿ƒåº“ç‹¬ç«‹

**é—®é¢˜**: å·¥å…·å‡½æ•°æ•£è½å„å¤„

**è§£å†³**: é›†ä¸­ç®¡ç†
```
lib/auth/   â†’ è®¤è¯ç›¸å…³
lib/db/     â†’ æ•°æ®åº“æ“ä½œ
lib/ai/     â†’ AIé›†æˆ
lib/game/   â†’ æ¸¸æˆé€»è¾‘
lib/utils/  â†’ é€šç”¨å·¥å…·
```

**ä¼˜åŠ¿**:
- âœ… æ˜“æŸ¥æ‰¾
- âœ… é¿å…é‡å¤
- âœ… ç»Ÿä¸€æ ‡å‡†

---

## ğŸ“Š ç»Ÿè®¡å¯¹æ¯”

| æŒ‡æ ‡ | æ—§æ¶æ„ | æ–°æ¶æ„ | æ”¹è¿› |
|------|--------|--------|------|
| é¡¶å±‚ç›®å½•æ•° | 8 | 14 | +75% (æ›´ç»†åˆ†) |
| ç»„ä»¶åˆ†ç±» | 1å±‚ | 3å±‚ | æ›´æ¸…æ™° |
| ä¸šåŠ¡æ¨¡å— | æ··åœ¨ç»„ä»¶ä¸­ | ç‹¬ç«‹`features/` | âœ… |
| ç±»å‹å®šä¹‰ | åˆ†æ•£ | é›†ä¸­`types/` | âœ… |
| é…ç½®æ–‡ä»¶ | æ··åœ¨æ ¹ç›®å½• | ç‹¬ç«‹`config/` | âœ… |
| æ–‡æ¡£ | é›¶æ•£ | ç‹¬ç«‹`docs/` | âœ… |
| æµ‹è¯• | æ—  | ç‹¬ç«‹`tests/` | âœ… |
| å·¥å…·è„šæœ¬ | æ—  | ç‹¬ç«‹`scripts/` | âœ… |

---

## ğŸš€ å‡çº§æ”¶ç›Š

### å¼€å‘ä½“éªŒ
- âœ… ä»£ç æ›´æ˜“æŸ¥æ‰¾
- âœ… æ¨¡å—æ›´æ˜“ç†è§£
- âœ… åŠŸèƒ½æ›´æ˜“æ‰©å±•
- âœ… å›¢é˜Ÿåä½œæ›´é¡ºç•…

### æ€§èƒ½
- âœ… Server Componentså‡å°‘å®¢æˆ·ç«¯JS
- âœ… è‡ªåŠ¨ä»£ç åˆ†å‰²
- âœ… æ›´å¥½çš„ç¼“å­˜ç­–ç•¥
- âœ… æµå¼æ¸²æŸ“

### ç»´æŠ¤æ€§
- âœ… èŒè´£åˆ†ç¦»æ¸…æ™°
- âœ… ä¾èµ–å…³ç³»æ˜ç¡®
- âœ… æµ‹è¯•è¦†ç›–å®Œæ•´
- âœ… æ–‡æ¡£é½å…¨

---

**æ¶æ„è®¾è®¡**: âœ… å·²æ‰¹å‡†  
**è¿ç§»è®¡åˆ’**: ğŸ“‹ å·²åˆ¶å®š  
**ä¸‹ä¸€æ­¥**: ğŸ”¨ å¼€å§‹æ‰§è¡Œ